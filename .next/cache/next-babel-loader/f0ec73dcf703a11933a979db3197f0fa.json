{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport Head from 'next/head';\nimport Router from 'next/router';\nimport { useCurrentUser } from '../lib/hooks';\n\nconst SignupPage = () => {\n  const [user, {\n    mutate\n  }] = useCurrentUser();\n  const {\n    0: errorMsg,\n    1: setErrorMsg\n  } = useState('');\n  useEffect(() => {\n    // redirect to home if user is authenticated\n    if (user) Router.replace('/');\n  }, [user]);\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const body = {\n      email: e.currentTarget.email.value,\n      name: e.currentTarget.name.value,\n      password: e.currentTarget.password.value\n    };\n    const res = await fetch('/api/users', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(body)\n    });\n\n    if (res.status === 201) {\n      const userObj = await res.json();\n      mutate(userObj);\n    } else {\n      setErrorMsg(await res.text());\n    }\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Head, null, __jsx(\"title\", null, \"Sign up\")), __jsx(\"div\", null, __jsx(\"h2\", null, \"Sign up\"), __jsx(\"form\", {\n    onSubmit: handleSubmit\n  }, errorMsg ? __jsx(\"p\", {\n    style: {\n      color: 'red'\n    }\n  }, errorMsg) : null, __jsx(\"label\", {\n    htmlFor: \"name\"\n  }, __jsx(\"input\", {\n    id: \"name\",\n    name: \"name\",\n    type: \"text\",\n    placeholder: \"Your name\"\n  })), __jsx(\"label\", {\n    htmlFor: \"email\"\n  }, __jsx(\"input\", {\n    id: \"email\",\n    name: \"email\",\n    type: \"email\",\n    placeholder: \"Email address\"\n  })), __jsx(\"label\", {\n    htmlFor: \"password\"\n  }, __jsx(\"input\", {\n    id: \"password\",\n    name: \"password\",\n    type: \"password\",\n    placeholder: \"Create a password\"\n  })), __jsx(\"button\", {\n    type: \"submit\"\n  }, \"Sign up\")), __jsx(\"p\", {\n    style: {\n      color: '#777',\n      textAlign: 'center'\n    }\n  }, \"Note: The database is public. For your privacy, please avoid using your personal, work email.\")));\n};\n\nexport default SignupPage;","map":null,"metadata":{},"sourceType":"module"}