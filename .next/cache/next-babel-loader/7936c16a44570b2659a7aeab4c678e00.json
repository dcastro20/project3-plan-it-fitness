{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport { useCurrentUser } from '../lib/hooks';\n\nconst LoginPage = () => {\n  const router = useRouter();\n  const {\n    0: errorMsg,\n    1: setErrorMsg\n  } = useState('');\n  const [user, {\n    mutate\n  }] = useCurrentUser();\n  useEffect(() => {\n    // redirect to home if user is authenticated\n    if (user) router.push('/');\n  }, [user]);\n\n  async function onSubmit(e) {\n    e.preventDefault();\n    const body = {\n      email: e.currentTarget.email.value,\n      password: e.currentTarget.password.value\n    };\n    const res = await fetch('/api/auth', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(body)\n    });\n\n    if (res.status === 200) {\n      const userObj = await res.json();\n      mutate(userObj);\n    } else {\n      setErrorMsg('Incorrect username or password. Try again!');\n    }\n  }\n\n  return __jsx(React.Fragment, null, __jsx(Head, null, __jsx(\"title\", null, \"Sign in\")), __jsx(\"h2\", null, \"Sign in\"), __jsx(\"form\", {\n    onSubmit: onSubmit\n  }, errorMsg ? __jsx(\"p\", {\n    style: {\n      color: 'red'\n    }\n  }, errorMsg) : null, __jsx(\"label\", {\n    htmlFor: \"email\"\n  }, __jsx(\"input\", {\n    id: \"email\",\n    type: \"email\",\n    name: \"email\",\n    placeholder: \"Email address\"\n  })), __jsx(\"label\", {\n    htmlFor: \"password\"\n  }, __jsx(\"input\", {\n    id: \"password\",\n    type: \"password\",\n    name: \"password\",\n    placeholder: \"Password\"\n  })), __jsx(\"button\", {\n    type: \"submit\"\n  }, \"Sign in\"), __jsx(Link, {\n    href: \"/forget-password\"\n  }, __jsx(\"a\", null, \"Forget password\"))));\n};\n\nexport default LoginPage;","map":null,"metadata":{},"sourceType":"module"}